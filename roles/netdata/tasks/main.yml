---
- name: "install Netdata"
  apt:
    name: "netdata"
    state: "latest"

- name: "copy Netdata settings"
  template:
    src: "netdata.conf.j2"
    dest: "{{ netdata_config_directory }}/netdata.conf"
    mode: "0600"
  notify: "restart Netdata"

- name: "start/enable Netdata"
  systemd:
    name: "netdata"
    state: "started"
    enabled: yes

- include_role:
    name: "nginx"
    tasks_from: "configure"
  vars:
    conf: "netdata.conf"
    credentials: "htpasswd.netdata"

- include_role:
    name: "monit"
    tasks_from: "configure"
  vars:
    conf: "netdata"

- include_role:
    name: "logrotate"
    tasks_from: "configure"
  vars:
    conf: "netdata"
